---
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# metameta: A Meta-meta-analysis Package for R

## Description

The `metameta` package is a collection of functions for 
meta-meta-analyses in R, which is useful for re-analysing published meta-analysis. Functions are
available to calculate the statistical power for each study in a
meta-analysis, based on data that is typically reported in
meta-analyses, and for creating a “Firepower” plot, which visualises the
median power of a meta-analysis assuming a range of true effect sizes.

## Usage
Install the package

```{r, message=FALSE}
devtools::install_github("dsquintana/metameta")
```


Calculate power for studies included in a published meta-analysis. Power for a range of "True" effect
sizes are calculated: The reported summary effect size estimate, and a range of effects from 0.1 to 1 (in increments of 0.1). Here, we're only showing the first 6 columns for the purposes of illustration, although the function calculates power for 11 true effect sizes in total.

```{r}
library(metameta)
library(dplyr)

power_ooi <- mapower_se(dat = dat_ooi, observed_es = 0.178, name = "ooi et al 2017")
power_ooi_dat <- power_ooi$dat
power_ooi_dat <- power_ooi_dat %>% select(1:6) # Select first 6 columns
power_ooi_dat
```

Create a firepower plot, which visualises the median power for assuming the observed effect size in the meta-analysis is the true effect size and assuming a range of true effect sizes ranging from 0.1 to 1 in increments of 0.1. 

```{r}
library(metameta)

### Calcuate median power for three meta-analyses
power_ooi <- mapower_se(dat = dat_ooi, observed_es = 0.178, name = "ooi et al 2017")
power_med_ooi <- power_ooi$power_median_dat

keech_power <- mapower_ul(dat = dat_keech, observed_es = 0.08, name = "Keech et al 2017")
power_med_keech <- keech_power$power_median_dat

power_bakermans_kranenburg <- 
  mapower_se(dat = dat_bakermans_kranenburg, observed_es = 0.32, 
             name = "Bakermans-Kranenburg et al 2013")
power_med_bakermans_kranenburg <- power_bakermans_kranenburg$power_median_dat

### Create a list
list_power <- list(power_med_ooi, power_med_keech, power_med_bakermans_kranenburg)

### Run firepower function
fp <- firepower(list_power)

### Create firepower plot
fp_plot <- fp$fp_plot
fp_plot
```
